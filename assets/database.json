[
 {
  "title": "Linux and the Device Tree",
  "date": 1609148589070,
  "thumbnail": "/assets/images/device_tree.svg",
  "category": ["Linux", "Device Tree"],
  "content": [
   "<p>畫了一張圖示意Device Tree的樣貌, 在這張圖裡面, 以RaspberryPi為參考, 說明dts中的參數是怎麼樣傳遞給Driver, 先認識一些關鍵字",
   "<ul>",
     "<li>Devicetree Specification: 定義dts的語法格式, 也定義了少量的通用的node資訊, 如cpu, memory..</li>",
     "<li>dts: Device Tree Source files</li>",
     "<li>dtsi: Device Tree Source Include files</li>",
     "<li>dtb: Device Tree Binary, 透過python script(dtc, device tree compiler), 將dts重構/trim/strip後的blob file</li>",
     "<li>Device Tree bindings: 就是dts的programming guide, 未規範在Devicetree Specification裡的node都應該要在這裡規範清楚, 位置在Documentation/devicetree/bindings</li>",
   "</ul>",
   "<img src='/assets/images/device_tree_overview.svg' style='width: 100%; object-fit: contain; style='border: 3px solid white;'>",
   "</p>",
   "<p>底下是原始碼的追溯與說明</p>",
   "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
      "pi@raspberrypi:~ $ dtc -q -I fs /proc/device-tree  | head<br />",
      "/dts-v1/;<br />",
      "<br />",
      "/ {<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;compatible = \"raspberrypi,model-b\\0brcm,bcm2835\";<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;serial-number = \"000000005468fcd3\";<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;model = \"Raspberry Pi Model B Rev 2\";<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;memreserve = < 0x1c000000 0x4000000 >;<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;interrupt-parent = < 0x01 >;<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;#address-cells = < 0x01 >;<br />",
      "&nbsp;&nbsp;&nbsp;&nbsp;#size-cells = < 0x01 >;<br />",
   "</div>",
   "<br />",
   "<p>根據compatible設定<span style='color: gray'>\"raspberrypi,model-b\", \"brcm,bcm2835\"</span>, 找到目標的dts檔<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm2835-rpi-b-rev2.dts', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">arm/boot/dts/bcm2835-rpi-b-rev2.dts</a></p>",
   "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
     "// SPDX-License-Identifier: GPL-2.0<br />",
     "/dts-v1/;<br />",
     "#include \"bcm2835.dtsi\"<br />",
     "#include \"bcm2835-rpi.dtsi\"<br />",
     "#include \"bcm283x-rpi-smsc9512.dtsi\"<br />",
     "#include \"bcm283x-rpi-usb-host.dtsi\"<br />",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Root Node, 主板定義</legend>",
     "<p style='color: gray'>原則上會看到與Layout相關的配置, 如RAM有多大, led, 周邊IC的參數設定, 已被SoC內化的控制器應放在bcm2835.dtsi, 讓其他也使用2835的板子可以引入不用重新hardcode</p>",
     "/ {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;compatible = \"raspberrypi,model-b-rev2\", \"brcm,bcm2835\";<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;model = \"Raspberry Pi Model B rev2\";<br />",
     "<br />",
     "<fieldset style='border: 1px solid blue'>",
     "<legend><a href='javascript:void(0)' onClick=\"window.open('https://devicetree-specification.readthedocs.io/en/latest/chapter3-devicenodes.html#memory-node', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">memory node</a></legend>",
     "&nbsp;&nbsp;&nbsp;&nbsp;memory@0 {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;device_type = \"memory\";<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reg = &lt;0 0x10000000&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;};<br />",
     "<span style='color: gray;'>//starting address 0, length 0x10000000(256MB), 實際上這片板子有512MB的RAM, 系統啟動完成後, 其中一部分割去給<a href='javascript:void(0)' onClick=\"window.open('https://www.raspberrypi.org/documentation/configuration/config-txt/memory.md', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">GPU使用(64MB)</a>, 最終可用的空間為0x1c000000(448MB)</span><br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid blue'>",
     "<legend><a href='javascript:void(0)' onClick=\"window.open('https://devicetree-specification.readthedocs.io/en/latest/chapter2-devicetree-basics.html?highlight=leds#generic-names-recommendation', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">leds node</a></legend>",
     "&nbsp;&nbsp;&nbsp;&nbsp;leds {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;act {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gpios = &lt;&gpio 16 GPIO_ACTIVE_LOW&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;};<br />",
     "<span style='color: gray;'>//Devicetree Specification沒有定義, 到Device Tree Binding去看看<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/leds/leds-gpio.yaml#L55', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/leds/leds-gpio.yaml</a>, node name是act, ACT是Raspberry Pi讀寫SD Card的指示燈, 以及一個名為gpios的屬性, 再查<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/gpio/gpio.txt', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/gpio/gpio.txt</a>, 第一個參數&gpio是一個<a href='javascript:void(0)' onClick=\"window.open('https://devicetree-specification.readthedocs.io/en/latest/chapter2-devicetree-basics.html#phandle', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">phandle value</a>, 代表參照另一個node name為gpio的節點, 其餘的兩個值為[offset to the GPIO line, GPIO Flag] </span><br />",
     "</fieldset>",
     "};<br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Expanded Node</legend>",
     "<span style='color: gray;'>",
       "// 原始node定義在<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm283x.dtsi#L107', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm283x.dtsi</a>, &gpio會幫原始node主體新增下面2個屬性gpio-line-names和pinctrl-0, 以及1個子節點i2s_alt2.<br />",
       "<ul style='padding-left: 1.2em; margin-top: 0;'>",
         "<li>gpio-line-names 可以對照電路圖第二頁左邊的針腳名稱標示</li>",
         "<li><a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/pinctrl/pinctrl-bindings.txt', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">pinctrl-0</a>: 這是一個phandle list, gpioout, alt0, i2s_alt2各自代表1個pin configuration node, 前面兩個定義在<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm2835-rpi.dtsi#L43', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm2835-rpi.dtsi</a>裡</li>",
         "<li>關於PINCTRL (PIN CONTROL) subsystem : <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/driver-api/pinctl.rst', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/driver-api/pinctl.rst</a></li>",
       "</ul>",
     "</span>",
     "&gpio {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;/*<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; * Taken from <a href='javascript:void(0)' onClick=\"window.open('https://github.com/pborreli/documentation-3/blob/master/hardware/raspberrypi/Raspberry-Pi-Rev-2.1-Model-AB-Schematics.pdf', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Raspberry-Pi-Rev-2.0-Model-AB-Schematics.pdf</a><br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; * RPI00022 sheet 02<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; *<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; * Legend:<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; * \"NC\" = not connected (no rail from the SoC)<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; * \"FOO\" = GPIO line named \"FOO\" on the schematic<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; * \"FOO_N\" = GPIO line named \"FOO\" on schematic, active low<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp; */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;gpio-line-names = \"SDA0\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SCL0\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SDA1\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SCL1\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO_GCLK\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"CAM_CLK\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"LAN_RUN\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SPI_CE1_N\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SPI_CE0_N\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SPI_MISO\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SPI_MOSI\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SPI_SCLK\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO12 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO13 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  /* Serial port */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"TXD0\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"RXD0\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"STATUS_LED_N\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO17\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO18\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO19 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO20 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"CAM_GPIO\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO22\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO23\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO24\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO25\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO26 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO27\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO28\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO29\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO30\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"GPIO31\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO32 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO33 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO34 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO35 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO36 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO37 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO38 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO39 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"PWM0_OUT\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO41 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO42 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO43 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"NC\", /* GPIO44 */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"PWM1_OUT\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"HDMI_HPD_P\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_CARD_DET\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  /* Used by SD Card */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_CLK_R\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_CMD_R\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_DATA0_R\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_DATA1_R\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_DATA2_R\",<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  \"SD_DATA3_R\";<br />",
     "<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-0 = &lt;&gpioout &alt0 &i2s_alt2&gt;;<br />",
     "<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;/* I2S interface */<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;i2s_alt2: i2s_alt2 {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;brcm,pins = &lt;28 29 30 31&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;brcm,function = &lt;BCM2835_FSEL_ALT2&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;};<br />",
     "};<br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Expanded Node</legend>",
     "<span style='color: gray;'>",
       "<ul style='padding-left: 1.2em; margin-top: 0;'>",
         "<li>hdmi主體位置: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm2835-common.dtsi#L123', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm2835-common.dtsi</a></li>",
         "<li>bcm2835-hdmi描述檔: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/display/brcm%2Cbcm2835-hdmi.yaml', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/display/brcm,bcm2835-hdmi.yaml</a></li>",
       "</ul>",
     "</span>",
     "&hdmi {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/display/brcm%2Cbcm2835-hdmi.yaml', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">hpd-gpios</a> = &lt;&gpio 46 GPIO_ACTIVE_HIGH&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/power/power_domain.txt', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">power-domains</a> = &lt;&power RPI_POWER_DOMAIN_HDMI&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:void(0)' onClick=\"window.open('https://devicetree-specification.readthedocs.io/en/latest/chapter2-devicetree-basics.html#status', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">status</a> = \"okay\";<br />",
     "};<br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Expanded Node</legend>",
     "<span style='color: gray;'>",
       "<ul style='padding-left: 1.2em; margin-top: 0;'>",
         "<li>pwm主體位置: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm283x.dtsi#L437', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm283x.dtsi</a></li>",
         "<li>描述檔: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/pwm/pwm-bcm2835.txt', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/pwm/pwm-bcm2835.txt</a></li>",
       "</ul>",
     "</span>",
     "&pwm {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-names = \"default\";<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-0 = &lt;&pwm0_gpio40 &pwm1_gpio45&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;status = \"okay\";<br />",
     "};<br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Expanded Node</legend>",
     "<span style='color: gray;'>",
       "<ul style='padding-left: 1.2em; margin-top: 0;'>",
         "<li>sdhost主體位置: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm283x.dtsi#L312', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm283x.dtsi</a></li>",
         "<li>描述檔: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/mmc/brcm%2Cbcm2835-sdhost.txt', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/mmc/brcm,bcm2835-sdhost.txt</a></li>",
       "</ul>",
     "</span>",
     "&sdhost {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-names = \"default\";<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-0 = &lt;&sdhost_gpio48&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/mmc/mmc-controller.yaml', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bus-width</a> = &lt;4&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;status = \"okay\";<br />",
     "};<br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Expanded Node</legend>",
     "<span style='color: gray;'>",
       "<ul style='padding-left: 1.2em; margin-top: 0;'>",
         "<li>uart0主體位置: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm283x.dtsi#L302', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm283x.dtsi</a></li>",
         "<li>描述檔: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/serial/pl011.yaml', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/serial/pl011.yaml</a></li>",
       "</ul>",
     "</span>",
     "&uart0 {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-names = \"default\";<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-0 = &lt;&uart0_gpio14&gt;;<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;status = \"okay\";<br />",
     "};<br />",
     "</fieldset>",
     "<br />",
     "<fieldset style='border: 1px solid red'>",
     "<legend>Expanded Node</legend>",
     "<span style='color: gray;'>",
       "<ul style='padding-left: 1.2em; margin-top: 0;'>",
         "<li>i2c0mux主體位置: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/arch/arm/boot/dts/bcm283x.dtsi#L347', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">bcm283x.dtsi</a></li>",
         "<li>描述檔: <a href='javascript:void(0)' onClick=\"window.open('https://github.com/raspberrypi/linux/blob/rpi-5.10.y/Documentation/devicetree/bindings/i2c/i2c-mux-pinctrl.txt', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Documentation/devicetree/bindings/i2c/i2c-mux-pinctrl.txt</a></li>",
       "</ul>",
     "</span>",
     "/* i2c0 on camera/display connector is gpio 0&1. Not exposed on header.<br />",
      "* To avoid having to remap everything, map both ports to gpios 0&1<br />",
      "*/<br />",
     "&i2c0mux {<br />",
     "&nbsp;&nbsp;&nbsp;&nbsp;pinctrl-1 = &lt;&i2c0_gpio0&gt;;<br />",
     "};<br />",
     "</fieldset>",
   "</div>"
  ]
 },
 {
  "title": "Install Ubuntu With LUSK, Without LVM",
  "date": 1606210500000,
  "thumbnail": "https://gitlab.com/cryptsetup/cryptsetup/-/wikis/luks-logo.png",
  "category": ["LUKS", "Ubuntu", "Ubuntu 20.04", "Debootstrap"],
  "content": [
    "<p>在Ubuntu的安裝程序中如果要啟用Linux Unified Key Setup(LUKS), 被迫得同時啟用Logical Volume Manager(LVM). 除此之外, Ubuntu Installer也強迫將LUKS規劃成LUKS1 / 512 bytes sector, 為了要對系統磁碟的LUKS做進階的調整, 將LUKS規劃成LUKS2, 4K對齊, 並剔除掉這層非必要的LVM, 今天手動對PC進行了一次Debootstrap安裝.</p>",
    "<ol>",
    "  <li>準備一張Ubuntu開機光碟: ubuntu-20.04.1-live-server-amd64.iso</li>",
    "  <li>在安裝畫面選單出現時, 按下ctrl + alt + F2 切換到terminal介面</li>",
    "  <li>分割磁區",
    "    <ul style='padding-left: 1.2em;'>",
    "      <li>",
    "        基於個人使用上的調整, 把開機磁區縮小成512M, 其中64M是EFI磁區, 剩餘的空間打算全部掛在'/'上.<br />",
    "        如果硬碟是4Kn + 512e的模式, fdisk預設的sector size會是512 bytes, 若想要使用4K對齊的檔案系統, 請注意所有partition分割點的sector index都要設定成8的倍數.",
    "      </li>",
    "    </ul>",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
          "fdisk /dev/sda<br />",
          "g-> creat new gpt<br />",
          "n-> +64M -> t 1 [change type to EFI System]<br />",
          "n-> ext4 +448M<br />",
          "n-> ext4",
        "</div>",
    "    <br />",
    "  </li>",
    "  <li>配置加密磁區",
    "    <ul style='padding-left: 1.2em;'>",
    "      <li>",
    "        採用LUKS2 + Key File加密 + 4Kn的設定",
    "      </li>",
    "    </ul>",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
          "cryptsetup luksFormat -d luks-key --type luks2 --sector-size=4096 /dev/sda3",
        "</div>",
    "    <br />",
    "  </li>",
    "  <li>格式化",
    "    <ul style='padding-left: 1.2em;'>",
    "      <li>格式化EFI磁區",
            "<div style='margin: 0 0 0 -1.2em; border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
              "mkfs.vfat -F 32 /dev/sda1",
            "</div>",
    "      </li>",
    "      <li>格式化boot磁區",
            "<div style='margin: 0 0 0 -1.2em; border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
              "mkfs.ext4 -b 4096 /dev/sda2",
            "</div>",
    "      </li>",
    "      <li>解密加密磁區/dev/sda3, 掛載在/dev/mapper/dm-crypt上, 格式化成4k對齊的ext4檔案系統",
            "<div style='margin: 0 0 0 -1.2em; border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
              "cryptsetup open -d luks-key /dev/sda3 dm-crypt<br />",
              "mkfs.ext4 -b 4096 /dev/mapper/dm-crypt",
            "</div>",
    "      </li>",
    "    </ul>",
    "    <br />",
    "  </li>",
    "  <li>配置目標檔案系統rootfs結構(以/dm-crypt當作根目錄為例), 並將/dev/sda1, /dev/sda2, /dev/mapper/dm-crypt掛上",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "mkdir -p /dm-crypt<br />",
           "mount /dev/mapper/dm-crypt /dm-crypt<br />",
           "mkdir -p /dm-crypt/boot<br />",
           "mount /dev/sda2 /dm-crypt/boot<br />",
           "mkdir -p /dm-crypt/boot/efi<br />",
           "mount /dev/sda1 /dm-crypt/boot/efi",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>安裝debootstrap套件, 對/dm-crypt安裝base system",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "apt-get update && apt-get install -y debootstrap<br />",
           "debootstrap --arch=amd64 --variant=minbase focal /dm-crypt http://tw.archive.ubuntu.com/ubuntu/",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>掛載必要的檔案系統到目標檔案系統根目錄中, 為chroot做準備",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "mount --bind /dev /dm-crypt/dev<br />",
           "mount -t devpts /dev/pts /dm-crypt/dev/pts<br />",
           "mount -t proc proc /dm-crypt/proc<br />",
           "mount -t sysfs sysfs /dm-crypt/sys<br />",
           "mount -t tmpfs tmpfs /dm-crypt/tmp<br />",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>配置crypttab, sdb1是我放置luks key的USB磁區, 請自行調整",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "echo \"# <target name> <source device> <key file> <options>\" > /dm-crypt/etc/crypttab<br />",
           "echo \"dm-crypt UUID=$(blkid -s UUID -o value /dev/sda3) /dev/disk/by-uuid/$(blkid -s UUID -o value /dev/sdb1):/luks-key luks,keyscript=/lib/cryptsetup/scripts/passdev\" >> /dm-crypt/etc/crypttab<br />",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>配置fstab",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "echo \"# /etc/fstab: static file system information.\" > /dm-crypt/etc/fstab <br />",
           "echo \"#\" >> /dm-crypt/etc/fstab <br />",
           "echo \"# Use 'blkid' to print the universally unique identifier for a\" >> /dm-crypt/etc/fstab <br />",
           "echo \"# device; this may be used with UUID= as a more robust way to name devices\" >> /dm-crypt/etc/fstab <br />",
           "echo \"# that works even if disks are added and removed. See fstab(5).\" >> /dm-crypt/etc/fstab <br />",
           "echo \"#\" >> /dm-crypt/etc/fstab<br />",
           "echo \"# <file system> <mount point>   <type>  <options>       <dump>  <pass>\" >> /dm-crypt/etc/fstab <br />",
           "echo \"# / was on /dev/mapper/dm-crypt during debootstrap installation\" >> /dm-crypt/etc/fstab<br />",
           "echo \"UUID=$(blkid -s UUID -o value /dev/mapper/dm-crypt) / ext4 defaults 0 0\" >> /dm-crypt/etc/fstab<br />",
           "echo \"# /boot was on /dev/sda2 during debootstrap installation\" >> /dm-crypt/etc/fstab<br />",
           "echo \"UUID=$(blkid -s UUID -o value /dev/sda2) /boot ext4 defaults 0 0\" >> /dm-crypt/etc/fstab<br />",
           "echo \"# /boot/efi was on /dev/sda1 during debootstrap installation\" >> /dm-crypt/etc/fstab<br />",
           "echo \"UUID=$(blkid -s UUID -o value /dev/sda1) /boot/efi vfat defaults 0 0\" >> /dm-crypt/etc/fstab<br />",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>調整/dm-crypt/etc/apt/sources.list</li>",
    "  <li>安裝linux kernel, grub-efi cryptsetup-initramfs ubuntu-minimal",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "chroot /dm-crypt /bin/bash -c \"apt-get update\"<br />",
           "chroot /dm-crypt /bin/bash -c \"apt-get install -y linux-image-generic linux-headers-generic grub-efi cryptsetup-initramfs ubuntu-minimal\"",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>配置/安裝 Bootloader",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "#Option<br />",
           "sed -e 's/GRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"/GRUB_CMDLINE_LINUX_DEFAULT=\"\"/g' -i /dm-crypt/etc/default/grub<br />",
           "#Option<br />",
           "echo \"GRUB_RECORDFAIL_TIMEOUT=5\" >> /dm-crypt/etc/default/grub<br />",
           "chroot /dm-crypt /bin/bash -c \"grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader=ubuntu --boot-directory=/boot/efi/EFI/ubuntu --recheck /dev/sda\"<br />",
           "chroot /dm-crypt /bin/bash -c \"grub-mkconfig --output=/boot/efi/EFI/ubuntu/grub/grub.cfg\"",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>新增administrator",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "chroot /dm-crypt /bin/bash -c \"adduser --disabled-password --gecos GECOS admin\"<br />",
           "chroot /dm-crypt /bin/bash -c \"echo 'admin:admin' | chpasswd\"<br />",
           "chroot /dm-crypt /bin/bash -c \"usermod -aG sudo admin\"",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>配置網路環境, 直接拷貝live disk中的設定檔來使用",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "cp /etc/netplan/50-cloud-init.yaml /dm-crypt/etc/netplan/",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>調整hostname",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "echo ubuntu-server > /dm-crypt/etc/hostname<br />",
           "sed -e 's/127.0.0.1\tlocalhost/127.0.0.1\tlocalhost ubuntu-server/g' -i /dm-crypt/etc/hosts<br />",
           "sed -e 's/::1\t\tlocalhost ip6-localhost ip6-loopback/::1\t\tlocalhost ip6-localhost ip6-loopback ubuntu-server/g' -i /dm-crypt/etc/hosts<br />",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>設定時區",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "chroot /dm-crypt /bin/bash -c \"locale-gen --purge en_US.UTF-8\"",
         "</div>",
    "    <br />",
    "  </li>",
    "  <li>安裝完成, 卸載所有檔案系統, 將有存有key file的USB隨身碟接上電腦, 重新啟動電腦",
         "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
           "umount /dm-crypt/tmp /dm-crypt/sys /dm-crypt/proc /dm-crypt/dev/pts /dm-crypt/dev /dm-crypt/boot/efi /dm-crypt/boot /dm-crypt<br />",
           "reboot",
         "</div>",
    "  </li>",
    "</ol>"
   ]
 },
 {
  "title": "Let’s Encrypt & Docker",
  "date": 1604807977000,
  "thumbnail": "https://letsencrypt.org/images/letsencrypt-logo-horizontal.svg",
  "category": ["Let’s Encrypt", "Docker"],
  "content": [
   "<p style='margin: 0;'>對我而言, 透過<a href='https://certbot.eff.org/docs/install.html#running-with-docker' target='_blank'>Certbot</a>容器取得免費HTTPS憑證有兩個好處, 紀錄一下方便自己複製貼上</p>",
   "<ul style='margin-top: 0; margin-left: -20px;'>",
   "  <li>隔離執行certbot的環境, 不用賦予certbot root的權限</li>",
   "  <li>以volume為存放媒介, 除了憑證外, 也同使保管其他憑證流程相關檔案, 較易於管理</li>",
   "</ul>",
   "<p style='margin: 0;'>取得/更新憑證</p>",
   "<ul style='margin-top: 0; margin-left: -20px;'>",
   "  <li>For x86_64<br />",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
   "      docker volume create certificates<br />",
   "      docker run -it --rm -v certificates:/etc/letsencrypt certbot/certbot certonly --manual -d example.com --preferred-challenges dns",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>For ARM64<br />",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
   "      docker volume create certificates<br />",
   "      docker run -it --rm -v certificates:/etc/letsencrypt certbot/certbot:arm64v8-latest certonly --manual -d example.com --preferred-challenges dns",
   "    </div>",
   "  </li>",
   "</ul>",
   "<p style='margin: 0;'>使用範例</p>",
   "<ul style='margin-top: 0; margin-left: -20px;'>",
   "  <li>將volume掛載到nginx容器上",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
   "      docker run -v certificates:/etc/letsencrypt nginx",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>調整nginx配置",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;'>",
   "      server {<br />",
   "        &nbsp;&nbsp;listen 443 ssl;<br />",
   "        &nbsp;&nbsp;server_name example.com;<br />",
   "        &nbsp;&nbsp;ssl_protocols TLSv1.2;<br />",
   "        &nbsp;&nbsp;ssl_certificate     /etc/letsencrypt/live/example.com/fullchain.pem;<br />",
   "        &nbsp;&nbsp;ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;<br />",
   "      }",
   "    </div>",
   "  </li>",
   "</ul>"
  ]
 },
 {
  "title": "Angular Single-Page Application",
  "date": 1584437538000,
  "thumbnail": "/assets/images/angular_logo_banner.svg",
  "category": ["Angular", "Frontend"],
  "content": [
    "<p>談談我喜歡Angular的幾個特點",
      "<ol>",
        "<li>物件導向設計概念",
          "<p>建構Angular UI的基本單元叫Component, Component是 HTML Element + Javascript + CSS 的容器模板. Component的設計讓靜態的HTML Element成為數據驅動(data driven)動態物件. Component擁有自己的<a href='javascript:void(0)' onClick=\"window.open('https://angular.io/guide/lifecycle-hooks', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">生命週期</a>, 讓開發者得以置入Javascript來引導UI容器的變化.</p>",
        "</li>",
        "<li>MVC分流",
          "<p>Component負責所有UI相關的事務, 資料的處理與同步交給Service物件. Service Class的成員有data變數和處理data用的函數<br />",
          "Angular使用了<span>@Injectable({providedIn: 'xxxx'})</span>的語法來修飾Service Class, 為Service物件帶來不同層級的unique instance效果, 這點在同步運用上真的是非常便利.</p>",
        "</li>",
        "<li>引入TypeScript作為建構語言, 平台與ECMAScript標準相容性問題交給Angular框架編譯流程處理",
          "<ul>",
            "<li><a href='javascript:void(0)' onClick=\"window.open('https://angular.io/guide/browser-support', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Browser Support</a></li>",
            "<li><a href='javascript:void(0)' onClick=\"window.open('https://angular.io/guide/typescript-configuration', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">TypeScript Compiler configuration</a></li>",
          "</ul>",
          "<p>如果沒有框架或第三方函示庫的協助, 就得浪費大把的時間在這<a href='javascript:void(0)' onClick=\"window.open('https://caniuse.com/?search=async', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Can I Use...</a>上頭</p>",
        "</li>",
        "<li>Angular不僅僅只是個Framework, 甚至有點接近IDE的等級",
          "<p>Google除了開發Angular外, 同時也推出適用於Angular的UI套件庫<a href='javascript:void(0)' onClick=\"window.open('https://material.angular.io/', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Angular Material</a>, 這個UI套件品質也很好, 很規矩地遵守responsive的設計概念, 兩者搭配幾乎可以滿足絕大部分網站的開發需求, 極大的縮短了網站開發的時間</p>",
        "</li>",
        "<li>Document品質不錯",
          "<p>除了給新人看的教學文件外, 幾乎所有API都有完整的參數說明, 程式碼範例 + live demo!</p>",
        "</li>",
        "<li>有富爸爸Google撐腰",
          "<p style='margin: 0'>開源框架有以下問題時, 我會避免使用</p>",
          "<ul>",
            "<li>團隊開發資源不足Bug叢生</li>",
            "<li>團隊未來有不確定性, 可能斷炊或解散</li>",
            "<li>團隊缺少有力的領導, 留下許多設計的問題無法決策, 常常得面臨自行思考workaround</li>",
          "</ul>",
          "<p></p>",
        "</li>",
        "<li>*ngIf, *ngFor, *ngSwitch, data-binding實在是有夠好用</li>",
      "</ol>",
    "</p>",
    "<hr>",
    "<p>來實作一個假想情境, 一份就醫紀錄系統. 用九個步驟, 以極少量的coding迅速的完成一個精巧的互動式網站. 相較於Angular官方的<a href='javascript:void(0)' onClick=\"window.open('https://angular.io/tutorial', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Hero tutorial</a>, 這個範例比較接近實務, 能讓人感受到Angular真正好用的地方, 但也複雜一些. 範例中關於<a href='javascript:void(0)' onClick=\"window.open('https://angular.io/guide/rx-library', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">RxJs</a>的使用就不多說明, 在Angular的框架中滿多地方會不得不用RxJs, 如果想把Angular玩上手, RxJs將會是必經的過程. <br />",
      "(stackblitz滿容易連線失敗的, 如果沒反應可以點開stackblitz的連結到stackblitz的網站上去看效果)",
      "<ol>",
        "<li>手繪UI假想頁面, 右上角有日期過濾器, 左邊科別欄位可收合, 紀錄卡可摺疊收合 <br/><img src='/assets/images/angular_sample_view.svg' width='100%' style='max-width:400px;'></li>",
        "<li>安排URI, 這個部份得啟用Angular Routing的功能才能使用, 主要的目的有兩個Friendly URI跟Lazy-loading, 依照這個UI功能選單的性質, 我會拆分成兩個類型獨立的子頁面, 檢驗報告和各科別診斷紀錄, 再以URI Query來分開各科別的尋訪, 讓各科別診斷紀錄都共用同一個Component Module. </li>",
        "<li>Layout安排<br/>",
        "在安排跨平台的Layout時滿我的策略很簡單, 二選一挑一個",
          "<ol>",
            "<li>定寬的卡片式排列(像是Instagram的排版)</li>",
            "<li>挑選一個能自動伸縮寬幅的欄位(通常是Main Content), 其餘欄位皆配置固定寬度</li>",
          "</ol>",
        "在這這個範例上我選擇第二個, 只讓紀錄卡隨螢幕寬幅彈性伸縮, 其餘皆固定寬度</li>",
        "<li>規劃Angular UI結構構<br><img src='/assets/images/angular_sample_component_view.svg' width='100%' style='max-width:400px;'>",
        "</li>",
      "</ol>",
    "</p>",
    "<p>開工<ol>",
      "<li>建立新的Angular APP, 並啟用routing",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "node@67d6bf8f5320:~$ ng new demo --style=css --routing<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/README.md (1021 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/.editorconfig (246 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/.gitignore (631 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/angular.json (3551 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/package.json (1281 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/tsconfig.json (489 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/tslint.json (1953 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/browserslist (429 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/karma.conf.js (1016 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/tsconfig.app.json (210 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/tsconfig.spec.json (270 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/favicon.ico (948 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/index.html (290 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/main.ts (372 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/polyfills.ts (2835 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/styles.css (80 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/test.ts (753 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/assets/.gitkeep (0 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/environments/environment.prod.ts (51 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/environments/environment.ts (662 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/app/app-routing.module.ts (246 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/app/app.module.ts (393 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/app/app.component.css (0 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/app/app.component.html (25755 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/app/app.component.spec.ts (1053 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/src/app/app.component.ts (208 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/e2e/protractor.conf.js (808 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/e2e/tsconfig.json (214 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/e2e/src/app.e2e-spec.ts (637 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> demo/e2e/src/app.po.ts (301 bytes)<br />",
          "<span style='color:#4E9A06'>✔</span> Packages installed successfully.<br />",
          "Successfully initialized git.",
        "</div>",
        "<br />",
        "<fieldset style='border: 0;word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step1?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz </a></legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step1?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>安裝Angular Material",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "node@67d6bf8f5320:~/demo$ ng add @angular/material<br />",
          "<span style='color:#4E9A06'>Installing packages for tooling via npm.</span><br />",
          "<span style='color:#4E9A06'>Installed packages for tooling via npm.</span><br />",
          "<span style='color:#4E9A06'>?</span> Choose a prebuilt theme name, or \"custom\" for a custom theme: Purple/Green       [ Preview: https://material.angular.io?theme=purple-green ]<br />",
          "<span style='color:#4E9A06'>?</span> Set up global Angular Material typography styles? Yes<br />",
          "<span style='color:#4E9A06'>?</span> Set up browser animations for Angular Material? Yes<br />",
          "UPDATE package.json (1345 bytes)<br />",
          "<span style='color:#4E9A06'>✔</span> Packages installed successfully.<br />",
          "UPDATE src/app/app.module.ts (502 bytes)<br />",
          "UPDATE angular.json (3718 bytes)<br />",
          "UPDATE src/index.html (507 bytes)<br />",
          "UPDATE src/styles.css (181 bytes)<br />",
        "</div>",
        "<br />",
      "</li>",
      "<li>刪除掉ng new所產生的預設模板, 替換成目標期望的Toolbar, SideNav, MainContent三個區塊, &lt;router-outlet&gt;放在MainContent內供Angular依URI替換內容<br />",
        "mat-typography 這個class是在執行ng add @angular/material時自動被入的, 應不需要手動新增, 用途請參<a href='javascript:void(0)' onClick=\"window.open('https://material.angular.io/guide/typography', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">https://material.angular.io/guide/typography</a><br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.module.ts</legend>",
            "import&nbsp;{&nbsp;BrowserModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser';<br />",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<br />",
            "<span style='color:#8A2BE2'>",
            "// 匯入Angular Material中需要用到的UI Template<br />",
            "import&nbsp;{&nbsp;MatButtonModule&nbsp;}&nbsp;from&nbsp;'@angular/material/button';<br />",
            "import&nbsp;{&nbsp;MatIconModule&nbsp;}&nbsp;from&nbsp;'@angular/material/icon';<br />",
            "import&nbsp;{&nbsp;MatSidenavModule&nbsp;}&nbsp;from&nbsp;'@angular/material/sidenav';<br />",
            "import&nbsp;{&nbsp;MatToolbarModule&nbsp;}&nbsp;from&nbsp;'@angular/material/toolbar';<br />",
            "</span>",
            "<br />",
            "import&nbsp;{&nbsp;AppRoutingModule&nbsp;}&nbsp;from&nbsp;'./app-routing.module';<br />",
            "import&nbsp;{&nbsp;AppComponent&nbsp;}&nbsp;from&nbsp;'./app.component';<br />",
            "import&nbsp;{&nbsp;BrowserAnimationsModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser/animations';<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;declarations:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppComponent<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;imports:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserModule,<br />",
            "<span style='color:#8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatButtonModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatIconModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatSidenavModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatToolbarModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppRoutingModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserAnimationsModule<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;providers:&nbsp;[],<br />",
            "&nbsp;&nbsp;bootstrap:&nbsp;[AppComponent]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
          "<br />",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.component.ts</legend>",
            "import&nbsp;{&nbsp;Component&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-root',<br />",
            "<span style='color:#8A2BE2'>",
            "// 將HTML template / CSS 改成inline style, 並刪除app.component.css  app.component.html<br />",
            "// 要不要使用inline style依照個人喜好, 我選擇一律採用inline style的考量是<br />",
            "// 1. 在直觀的使用上比較符合OOP的codeing style<br />",
            "// 2. 若HTML template很長很複雜怎麼辦?<br />",
            "//&nbsp;&nbsp;&nbsp;&nbsp;=> 我覺得這是不應該的, 如果有這麼複雜的component, 表示設計的思維應該還有空間更結構化一些, 應該適度的拆解成多個component<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-toolbar&nbsp;color=\"primary\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;(click)=\"sidenav.toggle()\"&gt;&lt;mat-icon&gt;list&lt;/mat-icon&gt;&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-toolbar&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-container&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav&nbsp;#sidenav&nbsp;mode=\"side\"&nbsp;opened&gt;Sidenav&nbsp;content&lt;/mat-sidenav&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-content&gt;&lt;router-outlet&gt;&lt;/router-outlet&gt;&lt;/mat-sidenav-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav-container&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;':host&nbsp;{&nbsp;display:&nbsp;flex;&nbsp;flex-direction:&nbsp;column;&nbsp;height:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-sidenav-container&nbsp;{&nbsp;flex:&nbsp;1;&nbsp;}',<br />",
            "&nbsp;&nbsp;]<br />",
            "</span>",
            "})<br />",
            "export&nbsp;class&nbsp;AppComponent&nbsp;{<br />",
            "&nbsp;&nbsp;title&nbsp;=&nbsp;'demo';<br />",
            "}<br />",
          "</fieldset>",
          "<br />",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend style='color: #8A2BE2'>刪除 app.component.css app.component.html</legend>",
          "node@67d6bf8f5320:~/demo/src/app$ <span style='color:#8A2BE2'>git rm app.component.css app.component.html</span><br />",
          "rm 'src/app/app.component.css'<br />",
          "rm 'src/app/app.component.html'<br />",
          "</fieldset>",
          "<br />",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/index.html</legend>",
            "&lt;!doctype&nbsp;html&gt;<br />",
            "&lt;html&nbsp;lang=\"en\"&gt;<br />",
            "&lt;head&gt;<br />",
            "&nbsp;&nbsp;&lt;meta&nbsp;charset=\"utf-8\"&gt;<br />",
            "&nbsp;&nbsp;&lt;title&gt;Demo&lt;/title&gt;<br />",
            "&nbsp;&nbsp;&lt;base&nbsp;href=\"/\"&gt;<br />",
            "&nbsp;&nbsp;&lt;meta&nbsp;name=\"viewport\"&nbsp;content=\"width=device-width,&nbsp;initial-scale=1\"&gt;<br />",
            "&nbsp;&nbsp;&lt;link&nbsp;rel=\"icon\"&nbsp;type=\"image/x-icon\"&nbsp;href=\"favicon.ico\"&gt;<br />",
            "&nbsp;&nbsp;&lt;link&nbsp;href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap\"&nbsp;rel=\"stylesheet\"&gt;<br />",
            "&nbsp;&nbsp;&lt;link&nbsp;href=\"https://fonts.googleapis.com/icon?family=Material+Icons\"&nbsp;rel=\"stylesheet\"&gt;<br />",
            "&lt;/head&gt;<br />",
            "&lt;body&nbsp;<span style='color: #8A2BE2'>class=\"mat-typography\"</span>&gt;<br />",
            "&nbsp;&nbsp;&lt;app-root&gt;&lt;/app-root&gt;<br />",
            "&lt;/body&gt;<br />",
            "&lt;/html&gt;<br />",
          "</fieldset>",
          "<br />",
        "</div>",
        "<br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step3?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: 在這個階段, 完成了Layout的雛型, SideNav 顯示/隱藏的按鈕也可以正常的運作, 還附帶Angular Material內建的動畫效果, 僅是調整短短幾行程式碼</legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step3?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>新增URI Entry Point為/report的Lazy-loading Module<ul style='padding-left: 1.2em'>",
       "<li>--module app.module將parent module指定為app.module</li>",
       "<li>--route report表示'report'這個Module的Domain為/report. 這個值是繼承組合出來的, 為parent module path(/) + child module path(report)</li></ul>",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "node@67d6bf8f5320:~/demo$ ng g module report --module app.module --routing --route report<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/report/report-routing.module.ts (344 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/report/report.module.ts (349 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/report/report.component.css (0 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/report/report.component.html (21 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/report/report.component.spec.ts (628 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/report/report.component.ts (275 bytes)<br />",
          "UPDATE src/app/app-routing.module.ts (344 bytes)<br />",
        "</div><br />",
        "調整路由設定<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app-routing.module.ts</legend>",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;Routes,&nbsp;RouterModule&nbsp;}&nbsp;from&nbsp;'@angular/router';<br />",
            "<br />",
            "const&nbsp;routes:&nbsp;Routes&nbsp;=&nbsp;[<br />",
            "&nbsp;&nbsp;<span style='color: gray'>// 執行ng g module report --module app.module --routing --route report時由Angular CLI自動更新</span><br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'report',&nbsp;loadChildren:&nbsp;()&nbsp;=>&nbsp;import('./report/report.module').then(m&nbsp;=>&nbsp;m.ReportModule)&nbsp;},<br />",
            "&nbsp;&nbsp;<span style='color: gray'>// 手動加入, ''代表是root path, '**'是Angular在路由設定上的萬用字元, 任何未定義的path都會被這個設定重新導向到/report</span><br />",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'',&nbsp;redirectTo:&nbsp;'/report',&nbsp;pathMatch:&nbsp;'full'&nbsp;},<br />",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'**',&nbsp;redirectTo:&nbsp;'/report'},<br />",
            "</span>",
            "];<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;imports:&nbsp;[RouterModule.forRoot(routes)],<br />",
            "&nbsp;&nbsp;exports:&nbsp;[RouterModule]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppRoutingModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "添加List Module<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.module.ts</legend>",
            "import&nbsp;{&nbsp;BrowserModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser';<br />",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<br />",
            "import&nbsp;{&nbsp;MatButtonModule&nbsp;}&nbsp;from&nbsp;'@angular/material/button';<br />",
            "import&nbsp;{&nbsp;MatIconModule&nbsp;}&nbsp;from&nbsp;'@angular/material/icon';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;MatListModule&nbsp;}&nbsp;from&nbsp;'@angular/material/list';<br />",
            "</span>",
            "import&nbsp;{&nbsp;MatSidenavModule&nbsp;}&nbsp;from&nbsp;'@angular/material/sidenav';<br />",
            "import&nbsp;{&nbsp;MatToolbarModule&nbsp;}&nbsp;from&nbsp;'@angular/material/toolbar';<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;<br />",
            "import&nbsp;{&nbsp;AppRoutingModule&nbsp;}&nbsp;from&nbsp;'./app-routing.module';<br />",
            "import&nbsp;{&nbsp;AppComponent&nbsp;}&nbsp;from&nbsp;'./app.component';<br />",
            "import&nbsp;{&nbsp;BrowserAnimationsModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser/animations';<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;declarations:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppComponent<br />",
            "&nbsp;&nbsp;],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />",
            "&nbsp;&nbsp;imports:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatButtonModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatIconModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatListModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatSidenavModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatToolbarModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppRoutingModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserAnimationsModule<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;providers:&nbsp;[],<br />",
            "&nbsp;&nbsp;bootstrap:&nbsp;[AppComponent]<br />",
            "})&nbsp;&nbsp;&nbsp;&nbsp;<br />",
            "export&nbsp;class&nbsp;AppModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "刪除 report.component.html, report.component.css. 將app.component.ts改成inline style, 並添加Report按鈕<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.component.ts</legend>",
            "import&nbsp;{&nbsp;Component&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-root',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-toolbar&nbsp;color=\"primary\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;(click)=\"sidenav.toggle()\"&gt;&lt;mat-icon&gt;list&lt;/mat-icon&gt;&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-toolbar&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-container&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav&nbsp;#sidenav&nbsp;mode=\"side\"&nbsp;opened&gt;<br />",
            "<span style='color: gray'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- routerLinkActive的用途是在URI尋訪到/report時, 會自動為所屬的HTML Element的classList加入active-link這個class --&gt;<br />",
            "</span>",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-nav-list&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-list-item&nbsp;routerLink=\"/report\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;routerLinkActive=\"active-link\"&gt;Report&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-list-item&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-nav-list&gt;<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-content&gt;&lt;router-outlet&gt;&lt;/router-outlet&gt;&lt;/mat-sidenav-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav-container&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;':host&nbsp;{&nbsp;display:&nbsp;flex;&nbsp;flex-direction:&nbsp;column;&nbsp;height:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-sidenav-container&nbsp;{&nbsp;flex:&nbsp;1;&nbsp;}',<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;'.active-link&nbsp;{&nbsp;color:&nbsp;#000000;&nbsp;background:&nbsp;#69F0AE;&nbsp;}',<br />",
            "</span>",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppComponent&nbsp;{<br />",
            "&nbsp;&nbsp;title&nbsp;=&nbsp;'demo';<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step4?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: 在這個階段, 新增子頁面/report, ReportComponent會在網址尋訪到/report時自動被載入到&lt;router-outlet&gt;的位置</legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step4?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>同上一步, 新增URI Entry Point為/diagnosis的Lazy-loading Module",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "node@67d6bf8f5320:~/demo$ ng g module diagnosis --module app.module --routing --route diagnosis<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/diagnosis/diagnosis-routing.module.ts (356 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/diagnosis/diagnosis.module.ts (370 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/diagnosis/diagnosis.component.css (0 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/diagnosis/diagnosis.component.html (24 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/diagnosis/diagnosis.component.spec.ts (649 bytes)<br />",
          "<span style='color:#4E9A06'>CREATE</span> src/app/diagnosis/diagnosis.component.ts (287 bytes)<br />",
          "UPDATE src/app/app-routing.module.ts (561 bytes)<br />",
        "</div><br />",
        "調整路由設定<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app-routing.module.ts</legend>",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;Routes,&nbsp;RouterModule&nbsp;}&nbsp;from&nbsp;'@angular/router';<br />",
            "<br />",
            "const&nbsp;routes:&nbsp;Routes&nbsp;=&nbsp;[<br />",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'report',&nbsp;loadChildren:&nbsp;()&nbsp;=>&nbsp;import('./report/report.module').then(m&nbsp;=>&nbsp;m.ReportModule)&nbsp;},<br />",
            "&nbsp;&nbsp;<span style='color: gray'>// 執行ng g module diagnosis --module app.module --routing --route diagnosis時由Angular CLI自動更新</span><br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'diagnosis',&nbsp;loadChildren:&nbsp;()&nbsp;=>&nbsp;import('./diagnosis/diagnosis.module').then(m&nbsp;=>&nbsp;m.DiagnosisModule)&nbsp;},<br />",
            "</span>",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'',&nbsp;redirectTo:&nbsp;'/report',&nbsp;pathMatch:&nbsp;'full'&nbsp;},<br />",
            "&nbsp;&nbsp;{&nbsp;path:&nbsp;'**',&nbsp;redirectTo:&nbsp;'/report'},<br />",
            "];<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;imports:&nbsp;[RouterModule.forRoot(routes)],<br />",
            "&nbsp;&nbsp;exports:&nbsp;[RouterModule]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppRoutingModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "添加科別按鈕, 利用*ngFor的模板讓Angular從deps變數中自動展開, <br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.component.ts</legend>",
            "import&nbsp;{&nbsp;Component&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-root',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-toolbar&nbsp;color=\"primary\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;(click)=\"sidenav.toggle()\"&gt;&lt;mat-icon&gt;list&lt;/mat-icon&gt;&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-toolbar&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-container&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav&nbsp;#sidenav&nbsp;mode=\"side\"&nbsp;opened&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-nav-list&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-list-item&nbsp;routerLink=\"/report\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;routerLinkActive=\"active-link\"&gt;Report&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-list-item&gt;<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-list-item&nbsp;*ngFor=\"let&nbsp;dep&nbsp;of&nbsp;deps\"&nbsp;routerLink=\"/diagnosis\"&nbsp;[queryParams]=\"{'dep':&nbsp;dep}\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;routerLinkActive=\"active-link\"&gt;{{&nbsp;dep&nbsp;}}&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-list-item&gt;<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-nav-list&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-content&gt;&lt;router-outlet&gt;&lt;/router-outlet&gt;&lt;/mat-sidenav-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav-container&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;':host&nbsp;{&nbsp;display:&nbsp;flex;&nbsp;flex-direction:&nbsp;column;&nbsp;height:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-sidenav-container&nbsp;{&nbsp;flex:&nbsp;1;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'.active-link&nbsp;{&nbsp;color:&nbsp;#000000;&nbsp;background:&nbsp;#69F0AE;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-list-item&nbsp;button&nbsp;{&nbsp;width:&nbsp;100%&nbsp;}',<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppComponent&nbsp;{<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;deps&nbsp;=&nbsp;['Orthopedics',&nbsp;'Pediatrics',&nbsp;'Dentistry',&nbsp;'ENT',&nbsp;'Thoracic'];<br />",
            "</span>",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "刪除 diagnosis.component.html, diagnosis.component.css 將diagnosis.component.ts改成inline style. 由於app.component.ts的routerLink有設定queryParams參數, 在DiagnosisComponent被載入時, 可以透過ActivatedRoute來取得queryParams, 藉此區別出使用者是按下了哪一個科別的按鈕.",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/diagnosis/diagnosis.component.ts</legend>",
            "import&nbsp;{&nbsp;Component,&nbsp;OnInit&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;ActivatedRoute&nbsp;}&nbsp;from&nbsp;'@angular/router';<br />",
            "</span>",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-diagnosis',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;{{&nbsp;dep&nbsp;}}&lt;/p&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;DiagnosisComponent&nbsp;implements&nbsp;OnInit&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;dep:&nbsp;string&nbsp;=&nbsp;'';<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(<span style='color: #8A2BE2'>private&nbsp;route:&nbsp;ActivatedRoute</span>)&nbsp;{&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;ngOnInit():&nbsp;void&nbsp;{<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;this.route.queryParams<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.subscribe(params&nbsp;=&gt;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.dep&nbsp;=&nbsp;params.dep;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;);<br />",
            "</span>",
            "&nbsp;&nbsp;}<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step5?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: 到這一步, 完成了Navbar上的所有按鈕和導向的功能</legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step5?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>在展示資料以前, 需要新增一個Angular Service來負責與後台的RESTful溝通. 運作的流程是當ReportComponent或DiagnosisComponent被載入時, 透過Component中ngOnInit()嵌入對Service發起請求資料的函數, 再由Service對後台發起HTTP GET來取得資料, 取得後台的資料後, Service會再將資料做重整回傳給ReportComponent或DiagnosisComponent展示在頁面上<br />",
        "<br />",
        "新增service<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "node@67d6bf8f5320:~/demo/src/app$ ng g service backend-agent<br />",
          "<span style='color: #4E9A06'>CREATE</span> src/app/backend-agent.service.spec.ts (388 bytes)<br />",
          "<span style='color: #4E9A06'>CREATE</span> src/app/backend-agent.service.ts (141 bytes)<br />",
        "</div><br />",
        "新增一隻偽裝成資料Response的response.json<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/assets/response.json</legend>",
            "<div style='height: 300px; overflow-y: auto'>",
            "[<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1195875300000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Report\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"temperautre\":&nbsp;36,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"pulse\":&nbsp;70,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"bp\":&nbsp;[120,&nbsp;80]<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1196393700000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Report\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"temperautre\":&nbsp;35,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"pulse\":&nbsp;66,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"bp\":&nbsp;[123,&nbsp;77]<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1197434100000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Report\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"temperautre\":&nbsp;37,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"pulse\":&nbsp;80,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"bp\":&nbsp;[108,&nbsp;70]<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1210558260000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Report\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"temperautre\":&nbsp;35.5,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"pulse\":&nbsp;68,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"bp\":&nbsp;[110,&nbsp;65]<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1270080600000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Report\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"temperautre\":&nbsp;35.3,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"pulse\":&nbsp;72,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"bp\":&nbsp;[117,&nbsp;84]<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1425377400000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Orthopedics\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Tendinitis\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1435918200000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Orthopedics\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"radial&nbsp;head&nbsp;fracture\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1483528200000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Orthopedics\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Tendinitis\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1546607400000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Orthopedics\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Tendinitis\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1294146600000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Pediatrics\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Common&nbsp;Cold\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1472994600000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Dentistry\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Caries\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1479388200000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"ENT\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Common&nbsp;Cold\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1542460200000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"ENT\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"Common&nbsp;Cold\"<br />",
            "&nbsp;&nbsp;},<br />",
            "&nbsp;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"date\":&nbsp;1576156200000,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"type\":&nbsp;\"Thoracic\",<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;\"diagnosis\":&nbsp;\"COVID-19\"<br />",
            "&nbsp;&nbsp;}<br />",
            "]<br />",
            "</div><br />",
          "</fieldset>",
        "</div><br />",
        "加入與後端溝通的HttpClient, 如果是還不熟悉RxJs的新手, 也可以用XMLHttpRequest搭配Promise來執行",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.module.ts</legend>",
            "import&nbsp;{&nbsp;BrowserModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;HttpClientModule&nbsp;}&nbsp;from&nbsp;'@angular/common/http';<br />",
            "</span>",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<br />",
            "import&nbsp;{&nbsp;MatButtonModule&nbsp;}&nbsp;from&nbsp;'@angular/material/button';<br />",
            "import&nbsp;{&nbsp;MatIconModule&nbsp;}&nbsp;from&nbsp;'@angular/material/icon';<br />",
            "import&nbsp;{&nbsp;MatListModule&nbsp;}&nbsp;from&nbsp;'@angular/material/list';<br />",
            "import&nbsp;{&nbsp;MatSidenavModule&nbsp;}&nbsp;from&nbsp;'@angular/material/sidenav';<br />",
            "import&nbsp;{&nbsp;MatToolbarModule&nbsp;}&nbsp;from&nbsp;'@angular/material/toolbar';<br />",
            "<br />",
            "import&nbsp;{&nbsp;AppRoutingModule&nbsp;}&nbsp;from&nbsp;'./app-routing.module';<br />",
            "import&nbsp;{&nbsp;AppComponent&nbsp;}&nbsp;from&nbsp;'./app.component';<br />",
            "import&nbsp;{&nbsp;BrowserAnimationsModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser/animations';<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;declarations:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppComponent<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;imports:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;HttpClientModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatButtonModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatIconModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatListModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatSidenavModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatToolbarModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppRoutingModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserAnimationsModule<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;providers:&nbsp;[],<br />",
            "&nbsp;&nbsp;bootstrap:&nbsp;[AppComponent]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/backend-agent.service.ts</legend>",
            "import&nbsp;{&nbsp;Injectable&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;HttpClient&nbsp;}&nbsp;from&nbsp;'@angular/common/http';<br />",
            "import&nbsp;{&nbsp;Observable&nbsp;}&nbsp;from&nbsp;'rxjs';<br />",
            "import&nbsp;{&nbsp;map&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "</span>",
            "<br />",
            "@Injectable({<br />",
            "&nbsp;&nbsp;providedIn:&nbsp;'root'<br />",
            "})<br />",
            "export&nbsp;class&nbsp;BackendAgentService&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(<span style='color: #8A2BE2'>private&nbsp;httpClient&nbsp;:&nbsp;HttpClient<span style='color: #8A2BE2'>)&nbsp;{&nbsp;}<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;public&nbsp;query(type:&nbsp;string)&nbsp;:&nbsp;Observable&lt;any[]&gt;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this.httpClient.get('/assets/response.json').pipe(<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map((e&nbsp;:&nbsp;[])&nbsp;=>&nbsp;e.filter((record&nbsp;:&nbsp;any)&nbsp;=>&nbsp;record.type&nbsp;==&nbsp;type))<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;);<br />",
            "&nbsp;&nbsp;}<br />",
            "</span>",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "將Service的函數嵌入到Component的Init Hook中",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/report/report.component.ts</legend>",
            "import&nbsp;{&nbsp;Component,&nbsp;OnInit&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'../backend-agent.service';<br />",
            "</span>",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-report',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;report&nbsp;works!&lt;/p&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;ReportComponent&nbsp;implements&nbsp;OnInit&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(<span style='color: #8A2BE2'>private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService</span>)&nbsp;{&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;ngOnInit():&nbsp;void&nbsp;{<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;this.backendAgent.query('Report').subscribe(e&nbsp;=&gt;&nbsp;console.log(e));<br />",
            "</span>",
            "&nbsp;&nbsp;}<br />",
            "<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/diagnosis/diagnosis.component.ts</legend>",
            "import&nbsp;{&nbsp;Component,&nbsp;OnInit&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;ActivatedRoute&nbsp;}&nbsp;from&nbsp;'@angular/router';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'../backend-agent.service';<br />",
            "import&nbsp;{&nbsp;map,&nbsp;concatMap&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "</span>",
            "<br />",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-diagnosis',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;{{&nbsp;dep&nbsp;}}&lt;/p&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;DiagnosisComponent&nbsp;implements&nbsp;OnInit&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;dep:&nbsp;string&nbsp;=&nbsp;'';<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;route:&nbsp;ActivatedRoute,&nbsp;<span style='color: #8A2BE2'>private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService</span>)&nbsp;{&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;ngOnInit():&nbsp;void&nbsp;{<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;this.route.queryParams.pipe(<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map(params&nbsp;=&gt;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.dep&nbsp;=&nbsp;params.dep;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;params.dep;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}),<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;concatMap(dep&nbsp;=&gt;&nbsp;this.backendAgent.query(dep))<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;).subscribe(e&nbsp;=&gt;&nbsp;console.log(e));<br />",
            "</span>",
            "&nbsp;&nbsp;}<br />",
            "<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step6?devtoolsheight=33&embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: 切換分頁時可以觀察到Angular Service透過HTTP Get從response.json中取得data的結果</legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step6?devtoolsheight=33&embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>排版Repor頁面UI展示資料, 這邊用<a href='javascript:void(0)' onClick=\"window.open('https://angular.io/guide/observables-in-angular#async-pipe', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Async pipe</a>/ngFor/&lt;mat-card&gt;來當作流程示範, 前幾個步驟中和套用&lt;mat-toolbar&gt;/&lt;mat-sidenav-container&gt;的流程相同<br />",
        "<a href='javascript:void(0)' onClick=\"window.open('https://angular.io/guide/observables-in-angular#async-pipe', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">Async pipe</a> 是 Angular 內建的功能, Async pipe 提供了Observable物件訂閱的自動化流程, 以下面的程式碼來說明, <span style='color: #8A2BE2'>reports$ : Observable&lt;any&gt; = ...</span> 在Observable物件reports$中指派了BackendAgentService.query(), 並且對query()回傳的jason array做了sort的動作, 但實際呼叫Observable.subscribe()的時間點則是在&lt;mat-card&gt;被insert到HTML DOM內的時候. ",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/report/report.module.ts</legend>",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;CommonModule&nbsp;}&nbsp;from&nbsp;'@angular/common';<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;MatCardModule&nbsp;}&nbsp;from&nbsp;'@angular/material/card';<br />",
            "</span>",
            "<br />",
            "import&nbsp;{&nbsp;ReportRoutingModule&nbsp;}&nbsp;from&nbsp;'./report-routing.module';<br />",
            "import&nbsp;{&nbsp;ReportComponent&nbsp;}&nbsp;from&nbsp;'./report.component';<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;declarations:&nbsp;[ReportComponent],<br />",
            "&nbsp;&nbsp;imports:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;CommonModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatCardModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;ReportRoutingModule<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;ReportModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/report/report.component.ts</legend>",
            "import&nbsp;{&nbsp;Component,&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'../backend-agent.service';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;Observable&nbsp;}&nbsp;from&nbsp;'rxjs';<br />",
            "import&nbsp;{&nbsp;map&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "</span>",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-report',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-card&nbsp;*ngFor=\"let&nbsp;report&nbsp;of&nbsp;reports$&nbsp;|&nbsp;async\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-card-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{&nbsp;report.date&nbsp;|&nbsp;date&nbsp;}}<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-card-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-card-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;pulse&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;{{&nbsp;report.pulse&nbsp;}}&nbsp;/&nbsp;minute&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;temperautre&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;{{&nbsp;report.temperautre&nbsp;}}&nbsp;&#176;C&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;BP&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;{{&nbsp;report.bp[0]&nbsp;}}&nbsp;mmHg&nbsp;/&nbsp;{{&nbsp;report.bp[1]&nbsp;}}&nbsp;mmHg&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-card-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-card&gt;<br />",
            "</span>",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-card&nbsp;{&nbsp;margin:&nbsp;30px&nbsp;0;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;gray;&nbsp;border-radius:&nbsp;25px;&nbsp;width:&nbsp;80%;&nbsp;left:&nbsp;10%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table&nbsp;{&nbsp;width:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table,&nbsp;tr,&nbsp;td&nbsp;{&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;white;&nbsp;border-collapse:&nbsp;collapse;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'td:first-child&nbsp;{&nbsp;width:&nbsp;20%;&nbsp;}',<br />",
            "</span>",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;ReportComponent&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService)&nbsp;{&nbsp;}<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;reports$&nbsp;:&nbsp;Observable&lt;any&gt;&nbsp;=&nbsp;this.backendAgent.query('Report').pipe(map(e=&gt;e.sort((a,&nbsp;b)=&gt;&nbsp;(b.date&nbsp;-&nbsp;a.date))));<br />",
            "</span>",
            "<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step7?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: </legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step7?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>再來進行diagnosis頁面的處理, 這邊會使用另一種Angular Martial UI template, &lt;mat-expansion-panel&gt;<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/diagnosis/diagnosis.module.ts</legend>",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;CommonModule&nbsp;}&nbsp;from&nbsp;'@angular/common';<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;MatButtonModule&nbsp;}&nbsp;from&nbsp;'@angular/material/button';<br />",
            "import&nbsp;{&nbsp;MatIconModule&nbsp;}&nbsp;from&nbsp;'@angular/material/icon';<br />",
            "import&nbsp;{&nbsp;MatExpansionModule&nbsp;}&nbsp;from&nbsp;'@angular/material/expansion';<br />",
            "</span>",
            "<br />",
            "import&nbsp;{&nbsp;DiagnosisRoutingModule&nbsp;}&nbsp;from&nbsp;'./diagnosis-routing.module';<br />",
            "import&nbsp;{&nbsp;DiagnosisComponent&nbsp;}&nbsp;from&nbsp;'./diagnosis.component';<br />",
            "<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;declarations:&nbsp;[DiagnosisComponent],<br />",
            "&nbsp;&nbsp;imports:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;CommonModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatButtonModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatIconModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatExpansionModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;DiagnosisRoutingModule<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;DiagnosisModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/diagnosis/diagnosis.component.ts</legend>",
            "import&nbsp;{&nbsp;Component&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;ActivatedRoute&nbsp;}&nbsp;from&nbsp;'@angular/router';<br />",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'../backend-agent.service';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;Observable&nbsp;}&nbsp;from&nbsp;'rxjs';<br />",
            "import&nbsp;{&nbsp;map,&nbsp;concatMap&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "</span>",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-diagnosis',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-accordion&nbsp;multi&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-expansion-panel&nbsp;*ngFor=\"let&nbsp;report&nbsp;of&nbsp;reports$&nbsp;|&nbsp;async\"&nbsp;expanded&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-expansion-panel-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-panel-description&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERTIFICATE&nbsp;OF&nbsp;DIAGNOSIS<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-icon&gt;medication&lt;/mat-icon&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-panel-description&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-expansion-panel-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Name&lt;/th&gt;&lt;td&gt;......&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Sex&lt;/th&gt;&lt;td&gt;....&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Date&nbsp;of&nbsp;Birth&lt;/th&gt;&lt;td&gt;......&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Nationality&lt;/th&gt;&lt;td&gt;....&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Passport&nbsp;No.&lt;/th&gt;&lt;td&gt;....&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Medical&nbsp;history&nbsp;No.&lt;/th&gt;&lt;td&gt;........&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Address&lt;/th&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;colspan='5'&gt;..........................&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Date&nbsp;of&nbsp;Examination&lt;/th&gt;&lt;td&nbsp;colspan='2'&gt;{{&nbsp;report.date&nbsp;|&nbsp;date&nbsp;}}&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Department&lt;/th&gt;&lt;td&nbsp;colspan='2'&gt;{{&nbsp;report.type&nbsp;}}&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;th&nbsp;colspan='6'&gt;Diagnosis&lt;/th&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;td&nbsp;colspan='6'&gt;{{&nbsp;report.diagnosis&nbsp;}}&lt;/td&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;th&nbsp;colspan='6'&gt;Doctor's&nbsp;Comment&lt;/th&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;td&nbsp;colspan='6'&gt;..........&lt;/td&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-expansion-panel&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-accordion&gt;<br />",
            "</span>",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-expansion-panel:first-child&nbsp;{&nbsp;margin-top:&nbsp;30px!important;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-expansion-panel&nbsp;{&nbsp;margin:&nbsp;30px&nbsp;0;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;gray;&nbsp;border-radius:&nbsp;25px!important;&nbsp;width:&nbsp;80%;&nbsp;left:&nbsp;10%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table&nbsp;{&nbsp;width:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table,&nbsp;tr,&nbsp;td,&nbsp;th&nbsp;{&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;white;&nbsp;border-collapse:&nbsp;collapse;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'th&nbsp;{&nbsp;color:&nbsp;darkgray;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'td,&nbsp;th&nbsp;{&nbsp;padding:&nbsp;5px;&nbsp;font-size:&nbsp;16px;&nbsp;}',<br />",
            "</span>",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;DiagnosisComponent&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;route:&nbsp;ActivatedRoute,&nbsp;private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService)&nbsp;{&nbsp;}<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;reports$&nbsp;:&nbsp;Observable&lt;any&gt;&nbsp;=&nbsp;this.route.queryParams.pipe(<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map(params&nbsp;=&gt;&nbsp;params.dep),<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;concatMap(dep&nbsp;=&gt;&nbsp;this.backendAgent.query(dep)),<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map(e=&gt;e.sort((a,&nbsp;b)=&gt;&nbsp;(b.date&nbsp;-&nbsp;a.date)))<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br />",
            "</span>",
            "<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step8?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: 試試點選科別按鈕看看UI展示的效果, 點選醫囑卡片右上角的符號會有收合的功能</legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step8?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
      "<li>加入日期篩選, 完成所有的功能<br />",
        "import Angular Material Datepicker相關的Module<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.module.ts</legend>",
            "import&nbsp;{&nbsp;BrowserModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser';<br />",
            "import&nbsp;{&nbsp;HttpClientModule&nbsp;}&nbsp;from&nbsp;'@angular/common/http';<br />",
            "import&nbsp;{&nbsp;NgModule&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;FormsModule&nbsp;}&nbsp;from&nbsp;'@angular/forms';<br />",
            "</span>",
            "<br />",
            "import&nbsp;{&nbsp;MatButtonModule&nbsp;}&nbsp;from&nbsp;'@angular/material/button';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;MatDatepickerModule&nbsp;}&nbsp;from&nbsp;'@angular/material/datepicker';<br />",
            "import&nbsp;{&nbsp;MatFormFieldModule&nbsp;}&nbsp;from&nbsp;'@angular/material/form-field';<br />",
            "</span>",
            "import&nbsp;{&nbsp;MatIconModule&nbsp;}&nbsp;from&nbsp;'@angular/material/icon';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;MatInputModule&nbsp;}&nbsp;from&nbsp;'@angular/material/input';<br />",
            "</span>",
            "import&nbsp;{&nbsp;MatListModule&nbsp;}&nbsp;from&nbsp;'@angular/material/list';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;MatNativeDateModule&nbsp;}&nbsp;from&nbsp;'@angular/material/core';<br />",
            "</span>",
            "import&nbsp;{&nbsp;MatSidenavModule&nbsp;}&nbsp;from&nbsp;'@angular/material/sidenav';<br />",
            "import&nbsp;{&nbsp;MatToolbarModule&nbsp;}&nbsp;from&nbsp;'@angular/material/toolbar';<br />",
            "<br />",
            "import&nbsp;{&nbsp;AppRoutingModule&nbsp;}&nbsp;from&nbsp;'./app-routing.module';<br />",
            "import&nbsp;{&nbsp;AppComponent&nbsp;}&nbsp;from&nbsp;'./app.component';<br />",
            "import&nbsp;{&nbsp;BrowserAnimationsModule&nbsp;}&nbsp;from&nbsp;'@angular/platform-browser/animations';<br />",
            "<br />",
            "@NgModule({<br />",
            "&nbsp;&nbsp;declarations:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppComponent<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;imports:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;FormsModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;HttpClientModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatButtonModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatDatepickerModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatFormFieldModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatIconModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatInputModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatListModule,<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatNativeDateModule,<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatSidenavModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;MatToolbarModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;AppRoutingModule,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;BrowserAnimationsModule<br />",
            "&nbsp;&nbsp;],<br />",
            "&nbsp;&nbsp;providers:&nbsp;[],<br />",
            "&nbsp;&nbsp;bootstrap:&nbsp;[AppComponent]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppModule&nbsp;{&nbsp;}<br />",
          "</fieldset>",
        "</div><br />",
        "新增ReplaySubject至Service中, 同時在query()中新增兩個可選參數, 提供查詢資料日期區間篩選的功能<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/backend-agent.service.ts</legend>",
            "import&nbsp;{&nbsp;Injectable&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;HttpClient&nbsp;}&nbsp;from&nbsp;'@angular/common/http';<br />",
            "import&nbsp;{&nbsp;Observable,&nbsp;<span style='color: #8A2BE2'>ReplaySubject</span>&nbsp;}&nbsp;from&nbsp;'rxjs';<br />",
            "import&nbsp;{&nbsp;map&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "<br />",
            "@Injectable({<br />",
            "&nbsp;&nbsp;providedIn:&nbsp;'root'<br />",
            "})<br />",
            "export&nbsp;class&nbsp;BackendAgentService&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;httpClient&nbsp;:&nbsp;HttpClient)&nbsp;{&nbsp;}<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;date&nbsp;:&nbsp;ReplaySubject&lt;any&gt;&nbsp;=&nbsp;new&nbsp;ReplaySubject(1);<br />",
            "</span>",
            "<br />",
            "&nbsp;&nbsp;public&nbsp;query(type:&nbsp;string,&nbsp;<span style='color: #8A2BE2'>start&nbsp;?:&nbsp;Date,&nbsp;end&nbsp;?:&nbsp;Date</span>)&nbsp;:&nbsp;Observable&lt;any[]&gt;&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;this.httpClient.get('/assets/response.json').pipe(<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map((e&nbsp;:&nbsp;[])&nbsp;=&gt;&nbsp;e.filter((record&nbsp;:&nbsp;any)&nbsp;=&gt;&nbsp;record.type&nbsp;==&nbsp;type)),<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map((e&nbsp;:&nbsp;[])&nbsp;=&gt;&nbsp;start&nbsp;?&nbsp;e.filter((record&nbsp;:&nbsp;any)&nbsp;=&gt;&nbsp;record.date&nbsp;&gt;&nbsp;start.getTime())&nbsp;:&nbsp;e),<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map((e&nbsp;:&nbsp;[])&nbsp;=&gt;&nbsp;end&nbsp;?&nbsp;e.filter((record&nbsp;:&nbsp;any)&nbsp;=&gt;&nbsp;record.date&nbsp;&lt;&nbsp;end.getTime())&nbsp;:&nbsp;e)<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;);<br />",
            "&nbsp;&nbsp;}<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "放置兩個Datepicker UI Component, 安插emitDate()函數, 當使用者異動日期區間時, 會觸發emitDate()對ReplaySubject推送通知<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/app.component.ts</legend>",
            "import&nbsp;{&nbsp;Component,&nbsp;<span style='color: #8A2BE2'>OnInit</span>&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "<span style='color: #8A2BE2'>",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'./backend-agent.service';<br />",
            "</span>",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-root',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-toolbar&nbsp;color=\"primary\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;(click)=\"sidenav.toggle()\"&gt;&lt;mat-icon&gt;list&lt;/mat-icon&gt;&lt;/button&gt;<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='title'&gt;{{&nbsp;title&nbsp;}}&lt;/span&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class='right'&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-form-field&nbsp;floatLabel=\"never\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-label&gt;Choose&nbsp;a&nbsp;start&nbsp;date&lt;/mat-label&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;matInput&nbsp;[matDatepicker]=\"start\"&nbsp;[(ngModel)]=\"startDate\"&nbsp;(dateChange)=\"emitDate()\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-datepicker-toggle&nbsp;matSuffix&nbsp;[for]=\"start\"&gt;&lt;/mat-datepicker-toggle&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-datepicker-toggle&nbsp;matSuffix&nbsp;(click)=\"startDate&nbsp;=&nbsp;undefined;&nbsp;emitDate()\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-icon&nbsp;matDatepickerToggleIcon&gt;clear&lt;/mat-icon&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-datepicker-toggle&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-datepicker&nbsp;#start&gt;&lt;/mat-datepicker&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-form-field&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-form-field&nbsp;floatLabel=\"never\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-label&gt;Choose&nbsp;a&nbsp;end&nbsp;date&lt;/mat-label&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;matInput&nbsp;[matDatepicker]=\"end\"&nbsp;[(ngModel)]=\"endDate\"&nbsp;(dateChange)=\"emitDate()\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-datepicker-toggle&nbsp;matSuffix&nbsp;[for]=\"end\"&gt;&lt;/mat-datepicker-toggle&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-datepicker-toggle&nbsp;matSuffix&nbsp;(click)=\"endDate&nbsp;=&nbsp;undefined;&nbsp;emitDate()\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-icon&nbsp;matDatepickerToggleIcon&gt;clear&lt;/mat-icon&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-datepicker-toggle&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-datepicker&nbsp;#end&gt;&lt;/mat-datepicker&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-form-field&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-toolbar&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-container&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav&nbsp;#sidenav&nbsp;mode=\"side\"&nbsp;opened&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-nav-list&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-list-item&nbsp;routerLink=\"/report\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;routerLinkActive=\"active-link\"&gt;Report&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-list-item&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-list-item&nbsp;*ngFor=\"let&nbsp;dep&nbsp;of&nbsp;deps\"&nbsp;routerLink=\"/diagnosis\"&nbsp;[queryParams]=\"{'dep':&nbsp;dep}\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button&nbsp;mat-raised-button&nbsp;routerLinkActive=\"active-link\"&gt;{{&nbsp;dep&nbsp;}}&lt;/button&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-list-item&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-nav-list&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-sidenav-content&gt;&lt;router-outlet&gt;&lt;/router-outlet&gt;&lt;/mat-sidenav-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-sidenav-container&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;':host&nbsp;{&nbsp;display:&nbsp;flex;&nbsp;flex-direction:&nbsp;column;&nbsp;height:&nbsp;100%;&nbsp;}',<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;&nbsp;&nbsp;'.right&nbsp;{&nbsp;margin-left:&nbsp;auto;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'.title&nbsp;{&nbsp;font-size:&nbsp;2em;&nbsp;padding-left:&nbsp;0.5em;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'.right&nbsp;&gt;&nbsp;mat-form-field&nbsp;{&nbsp;margin:&nbsp;1em;&nbsp;}',<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-sidenav-container&nbsp;{&nbsp;flex:&nbsp;1;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'.active-link&nbsp;{&nbsp;color:&nbsp;#000000;&nbsp;background:&nbsp;#69F0AE;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-list-item&nbsp;button&nbsp;{&nbsp;width:&nbsp;100%&nbsp;}',<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;AppComponent&nbsp;<span style='color: #8A2BE2'>implements&nbsp;OnInit</span>&nbsp;{<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;title&nbsp;=&nbsp;'Angular&nbsp;SPA&nbsp;Demo';<br />",
            "</span>",
            "&nbsp;&nbsp;deps&nbsp;=&nbsp;['Orthopedics',&nbsp;'Pediatrics',&nbsp;'Dentistry',&nbsp;'ENT',&nbsp;'Thoracic'];<br />",
            "<br />",
            "<span style='color: #8A2BE2'>",
            "&nbsp;&nbsp;startDate&nbsp;?:&nbsp;Date;<br />",
            "&nbsp;&nbsp;endDate&nbsp;?:&nbsp;Date;<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService)&nbsp;{&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;ngOnInit():&nbsp;void&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;this.emitDate();<br />",
            "&nbsp;&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;emitDate()&nbsp;{<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;this.backendAgent.date.next({start:&nbsp;this.startDate,&nbsp;end:&nbsp;this.endDate});<br />",
            "&nbsp;&nbsp;}<br />",
            "</span>",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "在report頁面上, 新增ReplaySubject的訂閱流程到report$物件中, 如此一來當日期區段被改變時, report$物件就會收到這個通知, 並依照新的時間區段重新查詢. 搭配Ansync Pipe使用, 重新查詢的資料便會自動展示到頁面上完全不需要做額外的coding<br />",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/report/report.component.ts</legend>",
            "import&nbsp;{&nbsp;Component&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'../backend-agent.service';<br />",
            "import&nbsp;{&nbsp;Observable&nbsp;}&nbsp;from&nbsp;'rxjs';<br />",
            "import&nbsp;{&nbsp;map,&nbsp;<span style='color: #8A2BE2'>concatMap</span>&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-report',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-card&nbsp;*ngFor=\"let&nbsp;report&nbsp;of&nbsp;reports$&nbsp;|&nbsp;async\"&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-card-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{&nbsp;report.date&nbsp;|&nbsp;date&nbsp;}}<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-card-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-card-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;pulse&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;{{&nbsp;report.pulse&nbsp;}}&nbsp;/&nbsp;minute&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;temperautre&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;{{&nbsp;report.temperautre&nbsp;}}&nbsp;&#176;C&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;BP&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;{{&nbsp;report.bp[0]&nbsp;}}&nbsp;mmHg&nbsp;/&nbsp;{{&nbsp;report.bp[1]&nbsp;}}&nbsp;mmHg&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-card-content&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-card&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-card&nbsp;{&nbsp;margin:&nbsp;30px&nbsp;0;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;gray;&nbsp;border-radius:&nbsp;25px;&nbsp;width:&nbsp;80%;&nbsp;left:&nbsp;10%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table&nbsp;{&nbsp;width:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table,&nbsp;tr,&nbsp;td&nbsp;{&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;white;&nbsp;border-collapse:&nbsp;collapse;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'td:first-child&nbsp;{&nbsp;width:&nbsp;20%;&nbsp;}',<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;ReportComponent&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService)&nbsp;{&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;reports$&nbsp;:&nbsp;Observable&lt;any&gt;&nbsp;=&nbsp;<span style='color: #8A2BE2'>this.backendAgent.date</span>.pipe(<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style='color: #8A2BE2'>concatMap(e&nbsp;=&gt;&nbsp;this.backendAgent.query('Report',&nbsp;e.start,&nbsp;e.end))</span>,<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map(e=&gt;e.sort((a,&nbsp;b)=&gt;&nbsp;(b.date&nbsp;-&nbsp;a.date)))<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "在diagnosis頁面上進行一樣的動作, 新增ReplaySubject的訂閱流程到report$物件中, 讓Asnyc Pipe自動處理後續的事情",
        "<div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff; font-family: monospace; overflow-wrap: break-word; line-break:normal;word-break: break-word;'>",
          "<fieldset style='word-break: break-word; min-inline-size: 0px;'><legend>src/app/diagnosis/diagnosis.component.ts</legend>",
            "import&nbsp;{&nbsp;Component&nbsp;}&nbsp;from&nbsp;'@angular/core';<br />",
            "import&nbsp;{&nbsp;ActivatedRoute&nbsp;}&nbsp;from&nbsp;'@angular/router';<br />",
            "import&nbsp;{&nbsp;BackendAgentService&nbsp;}&nbsp;from&nbsp;'../backend-agent.service';<br />",
            "import&nbsp;{&nbsp;Observable,&nbsp;<span style='color: #8A2BE2'>combineLatest</span>&nbsp;}&nbsp;from&nbsp;'rxjs';<br />",
            "import&nbsp;{&nbsp;map,&nbsp;concatMap&nbsp;}&nbsp;from&nbsp;'rxjs/operators';<br />",
            "<br />",
            "@Component({<br />",
            "&nbsp;&nbsp;selector:&nbsp;'app-diagnosis',<br />",
            "&nbsp;&nbsp;template:&nbsp;`<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-accordion&nbsp;multi&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-expansion-panel&nbsp;*ngFor=\"let&nbsp;report&nbsp;of&nbsp;reports$&nbsp;|&nbsp;async\"&nbsp;expanded&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-expansion-panel-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-panel-description&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CERTIFICATE&nbsp;OF&nbsp;DIAGNOSIS<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;mat-icon&gt;medication&lt;/mat-icon&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-panel-description&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-expansion-panel-header&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Name&lt;/th&gt;&lt;td&gt;......&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Sex&lt;/th&gt;&lt;td&gt;....&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Date&nbsp;of&nbsp;Birth&lt;/th&gt;&lt;td&gt;......&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Nationality&lt;/th&gt;&lt;td&gt;....&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Passport&nbsp;No.&lt;/th&gt;&lt;td&gt;....&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Medical&nbsp;history&nbsp;No.&lt;/th&gt;&lt;td&gt;........&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Address&lt;/th&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;colspan='5'&gt;..........................&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Date&nbsp;of&nbsp;Examination&lt;/th&gt;&lt;td&nbsp;colspan='2'&gt;{{&nbsp;report.date&nbsp;|&nbsp;date&nbsp;}}&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Department&lt;/th&gt;&lt;td&nbsp;colspan='2'&gt;{{&nbsp;report.type&nbsp;}}&lt;/td&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;th&nbsp;colspan='6'&gt;Diagnosis&lt;/th&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;td&nbsp;colspan='6'&gt;{{&nbsp;report.diagnosis&nbsp;}}&lt;/td&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;th&nbsp;colspan='6'&gt;Doctor's&nbsp;Comment&lt;/th&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;&lt;td&nbsp;colspan='6'&gt;..........&lt;/td&gt;&lt;/tr&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-expansion-panel&gt;<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&lt;/mat-accordion&gt;<br />",
            "&nbsp;&nbsp;`,<br />",
            "&nbsp;&nbsp;styles:&nbsp;[<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-expansion-panel:first-child&nbsp;{&nbsp;margin-top:&nbsp;30px!important;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'mat-expansion-panel&nbsp;{&nbsp;margin:&nbsp;30px&nbsp;0;&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;gray;&nbsp;border-radius:&nbsp;25px!important;&nbsp;width:&nbsp;80%;&nbsp;left:&nbsp;10%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table&nbsp;{&nbsp;width:&nbsp;100%;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'table,&nbsp;tr,&nbsp;td,&nbsp;th&nbsp;{&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;white;&nbsp;border-collapse:&nbsp;collapse;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'th&nbsp;{&nbsp;color:&nbsp;darkgray;&nbsp;}',<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;'td,&nbsp;th&nbsp;{&nbsp;padding:&nbsp;5px;&nbsp;font-size:&nbsp;16px;&nbsp;}',<br />",
            "&nbsp;&nbsp;]<br />",
            "})<br />",
            "export&nbsp;class&nbsp;DiagnosisComponent&nbsp;{<br />",
            "<br />",
            "&nbsp;&nbsp;constructor(private&nbsp;route:&nbsp;ActivatedRoute,&nbsp;private&nbsp;backendAgent&nbsp;:&nbsp;BackendAgentService)&nbsp;{&nbsp;}<br />",
            "<br />",
            "&nbsp;&nbsp;reports$&nbsp;:&nbsp;Observable&lt;any&gt;&nbsp;=&nbsp;<span style='color: #8A2BE2'>combineLatest([this.route.queryParams,&nbsp;this.backendAgent.date]).pipe(<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;concatMap((e&nbsp;:&nbsp;any)&nbsp;=&gt;&nbsp;this.backendAgent.query(e[0].dep,&nbsp;e[1].start,&nbsp;e[1].end)),<br />",
            "</span>",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map((e&nbsp;:&nbsp;any[])=&gt;e.sort((a,&nbsp;b)=&gt;&nbsp;(b.date&nbsp;-&nbsp;a.date)))<br />",
            "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);<br />",
            "}<br />",
          "</fieldset>",
        "</div><br />",
        "<fieldset style='border: 0; word-break: break-word; min-inline-size: 0px;'><legend>預覽 <a href='javascript:void(0)' onClick=\"window.open('https://stackblitz.com/edit/angular-demo-step9?embed=1&hideExplorer=1&theme=light&view=preview', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">stackblitz</a>: 玩玩看日期選單, 看看Angular Async Pipe自動化的威力</legend>",
          "<iframe src='https://stackblitz.com/edit/angular-demo-step9?embed=1&ctl=1&hideExplorer=1&theme=light&view=preview' style='width: 100%; height: 900px;' loading='lazy'></iframe>",
        "</fieldset>",
      "</li>",
    "</ol></p>"
  ]
 },
 {
  "title": "Raspberry Pi 客製化Image",
  "date": 1582536900000,
  "thumbnail": "https://upload.wikimedia.org/wikipedia/zh/c/cb/Raspberry_Pi_Logo.svg",
  "category": ["Raspberry Pi"],
  "content": [
   "<p>硬體: Raspberry Pi 3 Model B Rev 1.2</p>",
   "<p>完整的開機流程資訊請參考<a href=\"https://www.raspberrypi.org/documentation/hardware/raspberrypi/bootmodes/bootflow.md\" target=\"_blank\">官方網頁</a>說明, 以下示範要怎麼樣修改官方的Image以及官網上找不到的一些資訊.</p>",
   "<p>Raspberry Pi開機簡要流程</p>",
   "<ol style='padding-left: 30px;'>",
   "  <li>SoC Boot ROM, 這是BCM2837晶片內部的流程, 不可更改也不會壞, 若壞了就是整台報廢</li>",
   "  <li>Boot ROM啟動完成後會依據boot mode的設定去尋找boot device. SD / USB disk / ...</li>",
   "  <li>找到SD卡/USB隨身碟/USB外接應碟後, Boot ROM會嘗試讀取出第一個分割磁區裡的bootcode.bin(bootloader), 然後把主控權交棒給bootloader. 在這個步驟上有幾個官網沒有聲明的資訊如下",
   "    <ul>",
   "      <li>BCM2837的Boot ROM只認得MBR, GPT是不可用的, 也就是說當磁碟容量超過MBR的2.2T規格限制時, 這個裝置就無法拿來當Boot Device.</li>",
   "      <li>使用fdisk時, 放置bootloader的第一個磁區的格式必須是\"W95 FAT32 (LBA)\"</li>",
   "      <li>Raspbian官方的image是MBR+512bytes的設定, 如果你的儲存裝置是採用4K對齊的模式, <a href=\"https://www.raspberrypi.org/documentation/installation/installing-images/README.md\" target=\"_blank\">官網的燒錄方式</a>, 無論是balenaEtcher或是dd都不可用. 需要依照底下的流程自行製作開機SD卡/USB碟/外接應碟等</li>",
   "    </ul>",
   "  </li>",
   "  <li>Bootloader啟動後會讀取config.txt來決定要啟動哪一個Kernel Image, 同時把cmdline.txt傳遞給被啟動個kernel, 完成Bootloader的任務, 並將主控權交給Linux Kernel.</li>",
   "  <li>Kernel啟動完成後會執行systemd, 整個系統開機的流程到此結束</li>",
   "</ol>",
   "<p>依照這個流程運作的原理, 我們可以在Ubuntu 18.04上簡單的做出可開機的Raspbian系統</p>",
   "<ol style='padding-left: 30px;'>",
   "  <li><a href=\"https://www.raspberrypi.org/downloads/raspbian/\" target=\"_blank\">官網下載Rasbian</a></li>",
   "  <li>將Image掛起觀察",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff;'>",
   "      ivan@ubuntu:~$ sudo losetup -Pfv --show 2020-02-05-raspbian-buster-lite.img<br />",
   "      /dev/loop0<br />",
   "      ivan@ubuntu:~$ sudo losetup -a<br />",
   "      /dev/loop0: [2049]:1836372 (/home/ivan/2020-02-05-raspbian-buster-lite.img)<br />",
   "      ivan@ubuntu:~$ sudo fdisk -l /dev/loop0<br />",
   "      Disk /dev/loop0: 1.7 GiB, 1849688064 bytes, 3612672 sectors<br />",
   "      Units: sectors of 1 * 512 = 512 bytes<br />",
   "      Sector size (logical/physical): 512 bytes / 512 bytes<br />",
   "      I/O size (minimum/optimal): 512 bytes / 512 bytes<br />",
   "      Disklabel type: dos<br />",
   "      Disk identifier: 0x56cd6262<br />",
   "      <br />",
   "      Device       Boot  Start     End Sectors  Size Id Type<br />",
   "      /dev/loop0p1        8192  532479  524288  256M  c W95 FAT32 (LBA)<br />",
   "      /dev/loop0p2      532480 3612671 3080192  1.5G 83 Linux",
   "    </div>",
   "  <br />",
   "  <table style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "    <tbody>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Image</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>2020-02-05-raspbian-buster-lite.img</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Block Size</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>512 bytes</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td colspan='2'>Partition 1</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Partition Size</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>256M</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Partition Type Id</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>c</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Partition Type</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>W95 FAT32 (LBA)</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td colspan='2'>Partition 2</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Partition Size</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>1.5G</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Partition Type Id</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>83</td>",
   "      </tr>",
   "      <tr style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Partition Type</td>",
   "        <td style='border-collapse: collapse; border: 1px solid blue; padding: 3px;'>Linux</td>",
   "      </tr>",
   "    </tbody>",
   "  </table>",
   "  <br />",
   "</li>",
   "<li>準備格式化目標SD卡/硬碟, 以/dev/sdb為例, 將磁碟做成MBR格式, 第一個分區參考原始設定256M(請依實際的sector size計算所需的block數目), 其餘容量劃入第二個分區. 更改第一個分區的格式為c W95 FAT32 (LBA). 第二個分區本來就是83 Linux維持不更動",
   "  <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff;'>",
   "    ivan@ubuntu:~$ sudo fdisk /dev/sdb <br />",
   "    <br />",
   "    Welcome to fdisk (util-linux 2.27.1).  <br />",
   "    Changes will remain in memory only, until you decide to write them.  <br />",
   "    Be careful before using the write command.  <br />",
   "    <br />",
   "    Device does not contain a recognized partition table.  <br />",
   "    Created a new DOS disklabel with disk identifier 0x0ddb6234.  <br />",
   "    <br />",
   "    Command (m for help): m <br />",
   "    <br />",
   "    Help: <br />",
   "    <br />",
   "    DOS (MBR) <br />",
   "         a   toggle a bootable flag <br />",
   "         b   edit nested BSD disklabel <br />",
   "         c   toggle the dos compatibility flag <br />",
   "    <br />",
   "        Generic <br />",
   "         d   delete a partition <br />",
   "         F   list free unpartitioned space <br />",
   "         l   list known partition types <br />",
   "         n   add a new partition <br />",
   "         p   print the partition table <br />",
   "         t   change a partition type <br />",
   "         v   verify the partition table <br />",
   "         i   print information about a partition <br />",
   "    <br />",
   "        Misc <br />",
   "         m   print this menu <br />",
   "         u   change display/entry units <br />",
   "         x   extra functionality (experts only) <br />",
   "    <br />",
   "        Script <br />",
   "         I   load disk layout from sfdisk script file <br />",
   "         O   dump disk layout to sfdisk script file <br />",
   "    <br />",
   "        Save & Exit <br />",
   "         w   write table to disk and exit <br />",
   "         q   quit without saving changes <br />",
   "    <br />",
   "        Create a new label <br />",
   "         g   create a new empty GPT partition table <br />",
   "         G   create a new empty SGI (IRIX) partition table <br />",
   "         o   create a new empty DOS partition table <br />",
   "         s   create a new empty Sun partition table <br />",
   "    <br />",
   "    <br />",
   "      Command (m for help): o <br />",
   "      Created a new DOS disklabel with disk identifier 0x0f4ac62f.  <br />",
   "    <br />",
   "      Command (m for help): p <br />",
   "      Disk /dev/sdb: 10 GiB, 10737418240 bytes, 20971520 sectors <br />",
   "      Units: sectors of 1 * 512 = 512 bytes <br />",
   "      Sector size (logical/physical): 512 bytes / 512 bytes <br />",
   "      I/O size (minimum/optimal): 512 bytes / 512 bytes <br />",
   "      Disklabel type: dos <br />",
   "      Disk identifier: 0x0f4ac62f <br />",
   "    <br />",
   "      Command (m for help): n <br />",
   "      Partition type <br />",
   "         p   primary (0 primary, 0 extended, 4 free) <br />",
   "         e   extended (container for logical partitions) <br />",
   "      Select (default p): <br />",
   "    <br />",
   "      Using default response p.  <br />",
   "      Partition number (1-4, default 1): <br />",
   "      First sector (2048-20971519, default 2048): <br />",
   "      Last sector, +sectors or +size{K,M,G,T,P} (2048-20971519, default 20971519): +524287 <br />",
   "    <br />",
   "      Created a new partition 1 of type 'Linux' and of size 256 MiB.  <br />",
   "    <br />",
   "      Command (m for help): n <br />",
   "      Partition type <br />",
   "         p   primary (1 primary, 0 extended, 3 free) <br />",
   "         e   extended (container for logical partitions) <br />",
   "      Select (default p): p <br />",
   "      Partition number (2-4, default 2): <br />",
   "      First sector (526336-20971519, default 526336): <br />",
   "      Last sector, +sectors or +size{K,M,G,T,P} (526336-20971519, default 20971519): <br />",
   "    <br />",
   "      Created a new partition 2 of type 'Linux' and of size 9.8 GiB.  <br />",
   "    <br />",
   "      Command (m for help): p <br />",
   "      Disk /dev/sdb: 10 GiB, 10737418240 bytes, 20971520 sectors <br />",
   "      Units: sectors of 1 * 512 = 512 bytes <br />",
   "      Sector size (logical/physical): 512 bytes / 512 bytes <br />",
   "      I/O size (minimum/optimal): 512 bytes / 512 bytes <br />",
   "      Disklabel type: dos <br />",
   "      Disk identifier: 0x0f4ac62f <br />",
   "    <br />",
   "      Device     Boot  Start      End  Sectors  Size Id Type <br />",
   "      /dev/sdb1         2048   526335   524288  256M 83 Linux <br />",
   "      /dev/sdb2       526336 20971519 20445184  9.8G 83 Linux <br />",
   "    <br />",
   "      Command (m for help): t <br />",
   "      Partition number (1,2, default 2): 1 <br />",
   "      Partition type (type L to list all types): c <br />",
   "    <br />",
   "      Changed type of partition 'Linux' to 'W95 FAT32 (LBA)'.  <br />",
   "    <br />",
   "      Command (m for help): p <br />",
   "      Disk /dev/sdb: 10 GiB, 10737418240 bytes, 20971520 sectors <br />",
   "      Units: sectors of 1 * 512 = 512 bytes <br />",
   "      Sector size (logical/physical): 512 bytes / 512 bytes <br />",
   "      I/O size (minimum/optimal): 512 bytes / 512 bytes <br />",
   "      Disklabel type: dos <br />",
   "      Disk identifier: 0x0f4ac62f <br />",
   "    <br />",
   "      Device     Boot  Start      End  Sectors  Size Id Type <br />",
   "      /dev/sdb1         2048   526335   524288  256M  c W95 FAT32 (LBA) <br />",
   "      /dev/sdb2       526336 20971519 20445184  9.8G 83 Linux <br />",
   "    <br />",
   "      Command (m for help): w <br />",
   "      The partition table has been altered.  <br />",
   "      Calling ioctl() to re-read partition table.  <br />",
   "      Syncing disks.",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>格式化磁區",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff;'>",
   "      ivan@ubuntu:~$ sudo mkfs.fat -F 32 /dev/sdb1 <br />",
   "      mkfs.fat 3.0.28 (2015-05-16) <br />",
   "      ivan@ubuntu:~$ sudo mkfs.ext4 /dev/sdb2 <br />",
   "      mke2fs 1.42.13 (17-May-2015) <br />",
   "      Creating filesystem with 2555648 4k blocks and 638976 inodes <br />",
   "      Filesystem UUID: b0d55a53-dcea-4095-b9fe-b10924ea1f8c <br />",
   "      Superblock backups stored on blocks: <br />",
   "      32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632 <br />",
   "      <br />",
   "      Allocating group tables: done <br />",
   "      Writing inode tables: done <br />",
   "      Creating journal (32768 blocks): done <br />",
   "      Writing superblocks and filesystem accounting information: done",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>掛載來源Image的2個磁區和目標磁碟的兩個磁區",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff;'>",
   "      ivan@ubuntu:~$ sudo mount -v /dev/loop0p1 loop0p1 <br />",
   "      mount: /dev/loop0p1 mounted on /home/ivan/loop0p1.  <br />",
   "      ivan@ubuntu:~$ sudo mount -v /dev/loop0p2 loop0p2 <br />",
   "      mount: /dev/loop0p2 mounted on /home/ivan/loop0p2.  <br />",
   "      ivan@ubuntu:~$ sudo mount -v /dev/sdb1 usbsdb1 <br />",
   "      mount: /dev/sdb1 mounted on /home/ivan/usbsdb1.  <br />",
   "      ivan@ubuntu:~$ sudo mount -v /dev/sdb2 usbsdb2 <br />",
   "      mount: /dev/sdb2 mounted on /home/ivan/usbsdb2.",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>分別把檔案拷貝進對應的磁區中, 可以使用cp或是rsync",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff;'>",
   "      ivan@ubuntu:~$ sudo rsync -a --delete  loop0p1/ usbsdb1/<br />",
   "      ivan@ubuntu:~$ sudo rsync -a --delete --exclude=lost+found loop0p2/ usbsdb2/",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>接下來要調整目標磁區中cmdline.txt和/etc/fstab的設定, 把PARTUUID改成符合sdb1,sdb2的值",
   "    <div style='border-left: solid 10px lightblue; padding: 15px 15px 15px 5px; background: #ffffff;'>",
   "      ivan@ubuntu:~$ sudo blkid /dev/sdb1 /dev/sdb2 <br />",
   "      /dev/sdb1: UUID=\"DA46-AA61\" TYPE=\"vfat\" PARTUUID=\"0f4ac62f-01\" <br />",
   "      /dev/sdb2: UUID=\"b0d55a53-dcea-4095-b9fe-b10924ea1f8c\" TYPE=\"ext4\" PARTUUID=\"0f4ac62f-02\" <br />",
   "      <br />",
   "      ivan@ubuntu:~$ cat usbsdb1/cmdline.txt <br />",
   "      console=serial0,115200 console=tty1 root=PARTUUID=0f4ac62f-02 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait quiet init=/usr/lib/raspi-config/init_resize.sh <br />",
   "      <br />",
   "      ivan@ubuntu:~$ cat usbsdb2/etc/fstab <br />",
   "      proc                  /proc           proc    defaults          0       0 <br />",
   "      PARTUUID=0f4ac62f-01  /boot           vfat    defaults          0       2 <br />",
   "      PARTUUID=0f4ac62f-02  /               ext4    defaults,noatime  0       1",
   "    </div>",
   "    <br />",
   "  </li>",
   "  <li>umount usbsdb1 usbsdb2後就可以把這張sd卡/硬碟抽出來, 接到Raspberry Pi上後就可以順利啟動了</li>",
   "</ol>"
  ]
 },
 {
  "title": "Booting ARM Linux",
  "date": 1576412100000,
  "thumbnail": "/assets/images/linux_booting.svg",
  "category": ["Linux", "Booting", "ARM"],
  "content": [
    "<p>圖解一篇ARM SoC在進入kernel前, linux要求bootloader需負責的<a href='javascript:void(0)' onClick=\"window.open('https://www.kernel.org/doc/html/latest/arm/booting.html', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">部分</a><ol>",
      "<li>Setup and initialise the RAM.</li>",
      "<li>Initialise one serial port.</li>",
      "<li>Detect the machine type. </li>",
      "<li>Setup boot data: ATAGS or DTB <br />",
        "<span style='color: gray'>The kernel will differentiate between ATAGS and device tree booting by reading the memory pointed to by r2 and looking for either the flattened device tree block magic value (<a href='javascript:void(0)' onClick=\"window.open('https://devicetree-specification.readthedocs.io/en/latest/chapter5-flattened-format.html?highlight=0xd00dfeed#header', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">0xd00dfeed</a>) or the ATAG_CORE value at offset 0x4 from r2 (<a href='javascript:void(0)' onClick=\"window.open('http://www.simtec.co.uk/products/SWLINUX/files/booting_article.html#d0e428', '_blank', 'height=1080,width=1920,scrollbars=yes').focus(); return false;\">0x54410001</a>).</span>",
      "</li>",
      "<li>Load initramfs.(optional)</li>",
      "<li>Call the kernel image.</li>",
    "</ol></p>",
    "<img src='/assets/images/arm_boot.svg' width='100%' style='border: 3px solid white;'>"
  ]
 }
]
